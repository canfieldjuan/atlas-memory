# Modelfile for qwen3-coder with proper tool calling support
# Based on official Qwen3-Coder template from HuggingFace

FROM qwen3-coder:30b

# Tool calling template from Qwen/Qwen3-Coder-30B-A3B-Instruct tokenizer_config.json
TEMPLATE """
{{- if .System }}
<|im_start|>system
{{ .System }}
{{- if .Tools }}

# Tools

You have access to the following functions:

<tools>
{{- range .Tools }}
<function>
<name>{{ .Function.Name }}</name>
<description>{{ .Function.Description }}</description>
<parameters>
{{- range $name, $prop := .Function.Parameters.Properties }}
<parameter>
<name>{{ $name }}</name>
<type>{{ $prop.Type }}</type>
<description>{{ $prop.Description }}</description>
</parameter>
{{- end }}
</parameters>
</function>
{{- end }}
</tools>

If you choose to call a function ONLY reply in the following format with NO suffix:

<tool_call>
<function=example_function_name>
<parameter=example_parameter_1>
value_1
</parameter>
<parameter=example_parameter_2>
This is the value for the second parameter
that can span
multiple lines
</parameter>
</function>
</tool_call>

<IMPORTANT>
Reminder:
- Function calls MUST follow the specified format: an inner <function=...></function> block must be nested within <tool_call></tool_call> XML tags
- Required parameters MUST be specified
- You may provide optional reasoning for your function call in natural language BEFORE the function call, but NOT after
- If there is no function call available, answer the question like normal with your current knowledge and do not tell the user about function calls
</IMPORTANT>
{{- end }}
<|im_end|>
{{- end }}
{{- range .Messages }}
{{- if eq .Role "user" }}
<|im_start|>user
{{ .Content }}<|im_end|>
{{- else if eq .Role "assistant" }}
<|im_start|>assistant
{{ .Content }}<|im_end|>
{{- else if eq .Role "tool" }}
<|im_start|>user
<tool_response>
{{ .Content }}
</tool_response><|im_end|>
{{- end }}
{{- end }}
<|im_start|>assistant
"""

PARAMETER stop <|im_start|>
PARAMETER stop <|im_end|>
PARAMETER stop <|endoftext|>
PARAMETER temperature 0.7
PARAMETER top_k 20
PARAMETER top_p 0.8
